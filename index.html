<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>HSK 4 | –ö–∏—Ç–∞–π—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        html, body {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #8B0000;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #app {
            width: 100%;
            max-width: 390px;
            height: 100%;
            max-height: 844px;
            background: #FFF5F5;
            position: relative;
            box-shadow: 0 0 20px rgba(139, 0, 0, 0.3);
            border-radius: 40px;
            overflow: hidden;
        }

        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background: #FFF5F5;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }

        .screen.active {
            display: flex;
        }

        .status-bar {
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            font-size: 15px;
            font-weight: 600;
            color: #8B0000;
            background: #FFF5F5;
            flex-shrink: 0;
        }

        .red-button {
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            width: 90%;
            margin: 0 auto;
            display: block;
            flex-shrink: 0;
        }

        /* ... (—Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è) ... */

        /* ========== –†–ò–°–û–í–ê–ù–ò–ï –ö–ê–ö –í LAOSHI ========== */
        .laoshi-drawing {
            background: white;
            border-radius: 24px;
            padding: 20px;
            margin: 10px 20px;
            border: 2px solid #FFE4E1;
            text-align: center;
        }

        .laoshi-title {
            font-size: 18px;
            color: #8B0000;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .laoshi-translation {
            font-size: 32px;
            color: #8B0000;
            margin: 10px 0 20px;
            font-weight: 600;
            padding: 10px;
            background: #FFF5F5;
            border-radius: 16px;
            border: 2px solid #FFE4E1;
        }

        /* –ö–∞–Ω–≤–∞ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è */
        .laoshi-canvas-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 10px auto;
            border: 3px solid #8B0000;
            border-radius: 20px;
            background: white;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(139, 0, 0, 0.2);
            touch-action: none;
        }

        #laoshi-canvas {
            width: 100%;
            height: 100%;
            display: block;
            touch-action: none;
            cursor: crosshair;
            background: white;
        }

        /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ */
        .laoshi-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 100px;
            color: rgba(139, 0, 0, 0.15);
            font-weight: 600;
            pointer-events: none;
            z-index: 1;
            font-family: 'KaiTi', 'Ê•∑‰Ωì', 'STKaiti', serif;
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —á–µ—Ä—Ç */
        .stroke-indicator {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 15px 0;
            padding: 10px;
            background: #FFF5F5;
            border-radius: 30px;
        }

        .stroke-dot {
            width: 30px;
            height: 30px;
            border-radius: 15px;
            background: #FFE4E1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #8B0000;
            font-weight: 500;
        }

        .stroke-dot.active {
            background: #8B0000;
            color: white;
            transform: scale(1.1);
        }

        .stroke-dot.completed {
            background: #4CAF50;
            color: white;
        }

        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .laoshi-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .laoshi-btn {
            padding: 14px 24px;
            background: white;
            border: 2px solid #FFE4E1;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            color: #8B0000;
            transition: 0.2s;
            min-width: 100px;
            touch-action: manipulation;
        }

        .laoshi-btn.primary {
            background: #8B0000;
            color: white;
            border-color: #8B0000;
        }

        .laoshi-btn.hint {
            background: #FFE4E1;
            color: #8B0000;
            border-color: #8B0000;
        }

        .laoshi-btn:active {
            transform: scale(0.95);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
        @keyframes hintFlash {
            0% { opacity: 0.2; }
            50% { opacity: 0.8; }
            100% { opacity: 0.2; }
        }

        .hint-active {
            animation: hintFlash 1s infinite;
        }

        /* –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å */
        .drawing-feedback {
            margin: 10px 0;
            font-size: 16px;
            color: #666;
        }

        .correct-feedback {
            color: #4CAF50;
            font-weight: 600;
        }

        .wrong-feedback {
            color: #f44336;
            font-weight: 600;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞ */
        @keyframes successPulse {
            0% { border-color: #8B0000; }
            50% { border-color: #4CAF50; box-shadow: 0 0 20px #4CAF50; }
            100% { border-color: #8B0000; }
        }

        .success-animation {
            animation: successPulse 1s;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- –ó–¥–µ—Å—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏, –Ω–æ —Å –Ω–æ–≤—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —Ä–∏—Å–æ–≤–∞–Ω–∏—è -->
        <!-- –Ø –ø–æ–∫–∞–∂—É —Ç–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—É—é —á–∞—Å—Ç—å —Å —Ä–∏—Å–æ–≤–∞–Ω–∏–µ–º, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –æ—Ç–≤–µ—Ç–µ -->
    </div>

    <script>
        // ============================================
        // –†–ò–°–û–í–ê–ù–ò–ï –ö–ê–ö –í LAOSHI
        // ============================================
        
        class LaoshiDrawing {
            constructor() {
                this.canvas = null;
                this.ctx = null;
                this.isDrawing = false;
                this.lastX = 0;
                this.lastY = 0;
                this.currentWord = null;
                this.strokes = [];
                this.currentStroke = [];
                this.strokeCount = 0;
                this.hintTimer = null;
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
                this.canvasSize = 300;
                this.gridSize = 20; // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–µ—Ç–∫—É 15x15 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
                this.strokeThreshold = 5; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —à—Ç—Ä–∏—Ö–∞
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–Ω–≤—ã
            init(word) {
                this.currentWord = word;
                this.strokes = [];
                this.currentStroke = [];
                this.strokeCount = 0;
                
                setTimeout(() => {
                    this.canvas = document.getElementById('laoshi-canvas');
                    if (!this.canvas) return;
                    
                    this.ctx = this.canvas.getContext('2d');
                    this.setupCanvas();
                    this.addEventListeners();
                    this.updateStrokeIndicator();
                }, 100);
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–≤—ã
            setupCanvas() {
                this.ctx.strokeStyle = '#8B0000';
                this.ctx.lineWidth = 8;
                this.ctx.lineCap = 'round';
                this.ctx.lineJoin = 'round';
                this.ctx.shadowBlur = 4;
                this.ctx.shadowColor = 'rgba(139, 0, 0, 0.3)';
                this.clear();
            }

            // –û—á–∏—Å—Ç–∫–∞ –∫–∞–Ω–≤—ã
            clear() {
                this.ctx.clearRect(0, 0, this.canvasSize, this.canvasSize);
                this.ctx.fillStyle = 'white';
                this.ctx.fillRect(0, 0, this.canvasSize, this.canvasSize);
                this.strokes = [];
                this.currentStroke = [];
                this.strokeCount = 0;
                this.updateStrokeIndicator();
            }

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            addEventListeners() {
                // –ú—ã—à—å
                this.canvas.addEventListener('mousedown', (e) => this.startDrawing(e));
                this.canvas.addEventListener('mousemove', (e) => this.draw(e));
                this.canvas.addEventListener('mouseup', () => this.stopDrawing());
                this.canvas.addEventListener('mouseleave', () => this.stopDrawing());
                
                // Touch
                this.canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    this.startDrawing(touch);
                });
                
                this.canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    this.draw(touch);
                });
                
                this.canvas.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    this.stopDrawing();
                });
                
                this.canvas.addEventListener('touchcancel', (e) => {
                    e.preventDefault();
                    this.stopDrawing();
                });
            }

            // –ù–∞—á–∞–ª–æ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
            startDrawing(e) {
                this.isDrawing = true;
                const pos = this.getCoordinates(e);
                this.lastX = pos.x;
                this.lastY = pos.y;
                
                this.ctx.beginPath();
                this.ctx.moveTo(this.lastX, this.lastY);
                
                // –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π —à—Ç—Ä–∏—Ö
                this.currentStroke = [{ x: this.lastX, y: this.lastY }];
            }

            // –†–∏—Å–æ–≤–∞–Ω–∏–µ
            draw(e) {
                if (!this.isDrawing) return;
                
                const pos = this.getCoordinates(e);
                const currentX = pos.x;
                const currentY = pos.y;
                
                // –†–∏—Å—É–µ–º –ª–∏–Ω–∏—é
                this.ctx.lineTo(currentX, currentY);
                this.ctx.stroke();
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫—É –≤ —Ç–µ–∫—É—â–∏–π —à—Ç—Ä–∏—Ö
                this.currentStroke.push({ x: currentX, y: currentY });
                
                this.lastX = currentX;
                this.lastY = currentY;
            }

            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
            stopDrawing() {
                if (this.isDrawing && this.currentStroke.length > this.strokeThreshold) {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —à—Ç—Ä–∏—Ö
                    this.strokes.push([...this.currentStroke]);
                    this.strokeCount++;
                    this.updateStrokeIndicator();
                }
                this.isDrawing = false;
                this.ctx.closePath();
                this.currentStroke = [];
            }

            // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
            getCoordinates(e) {
                const rect = this.canvas.getBoundingClientRect();
                const scaleX = this.canvas.width / rect.width;
                const scaleY = this.canvas.height / rect.height;
                
                let clientX, clientY;
                
                if (e.touches) {
                    clientX = e.touches[0].clientX;
                    clientY = e.touches[0].clientY;
                } else {
                    clientX = e.clientX;
                    clientY = e.clientY;
                }
                
                let x = (clientX - rect.left) * scaleX;
                let y = (clientY - rect.top) * scaleY;
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                x = Math.max(5, Math.min(this.canvasSize - 5, x));
                y = Math.max(5, Math.min(this.canvasSize - 5, y));
                
                return { x, y };
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —à—Ç—Ä–∏—Ö–æ–≤
            updateStrokeIndicator() {
                const container = document.getElementById('stroke-indicator');
                if (!container) return;
                
                const expectedStrokes = this.getExpectedStrokes(this.currentWord.characters);
                let html = '';
                
                for (let i = 0; i < expectedStrokes; i++) {
                    let status = '';
                    if (i < this.strokeCount) status = 'completed';
                    else if (i === this.strokeCount) status = 'active';
                    
                    html += `<div class="stroke-dot ${status}">${i + 1}</div>`;
                }
                
                container.innerHTML = html;
            }

            // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —à—Ç—Ä–∏—Ö–æ–≤ (—É–ø—Ä–æ—â–µ–Ω–Ω–æ)
            getExpectedStrokes(char) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —à—Ç—Ä–∏—Ö–æ–≤
                // –î–ª—è –¥–µ–º–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 3 –¥–æ 8
                const strokeMap = {
                    'Âπ≤': 3, 'ÊùØ': 8, 'È•º': 9, 'È•∫': 9, 'Ê±§': 6,
                    'Ë•ø': 6, 'Á∫¢': 6, 'Êüø': 9, 'Áì∂': 10, 'ÂàÄ': 2,
                    'Â∑ß': 5, 'ÂÖã': 7, 'Âäõ': 2, 'È•Æ': 7, 'Êñô': 10,
                    'È£ü': 9, 'ÂìÅ': 9, 'Ëæ£': 14, 'ÈÖ∏': 14, 'Âí∏': 9,
                    'Ëã¶': 8, 'Â∞ù': 9, 'Êàê': 6, 'ÁÜü': 15, 'Âë≥': 8,
                    'ÈÅì': 12, 'È°ø': 10, 'È¶ô': 9, 'Áõê': 10
                };
                
                for (let c of char) {
                    if (strokeMap[c]) return strokeMap[c];
                }
                return Math.floor(Math.random() * 5) + 3; // 3-7 —à—Ç—Ä–∏—Ö–æ–≤
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
            showHint() {
                const hintElement = document.getElementById('laoshi-hint');
                if (!hintElement) return;
                
                hintElement.style.opacity = '0.3';
                hintElement.classList.add('hint-active');
                
                if (this.hintTimer) clearTimeout(this.hintTimer);
                
                this.hintTimer = setTimeout(() => {
                    hintElement.style.opacity = '0';
                    hintElement.classList.remove('hint-active');
                }, 3000);
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
            check() {
                if (this.strokeCount === 0) {
                    this.showHint();
                    return false;
                }
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–º Laoshi –∑–¥–µ—Å—å —Å–ª–æ–∂–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
                // –î–ª—è –¥–µ–º–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É:
                // - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à—Ç—Ä–∏—Ö–æ–≤
                // - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∏—Å–æ–≤–∞–Ω–∏—è
                
                const expectedStrokes = this.getExpectedStrokes(this.currentWord.characters);
                const density = this.calculateDensity();
                
                const isCorrect = Math.abs(this.strokeCount - expectedStrokes) <= 2 && density > 0.3;
                
                if (isCorrect) {
                    // –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
                    this.canvas.classList.add('success-animation');
                    setTimeout(() => {
                        this.canvas.classList.remove('success-animation');
                    }, 1000);
                    
                    return true;
                } else {
                    this.showHint();
                    return false;
                }
            }

            // –†–∞—Å—á–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ä–∏—Å–æ–≤–∞–Ω–∏—è (—Å–∫–æ–ª—å–∫–æ –ø–∏–∫—Å–µ–ª–µ–π –∑–∞–∫—Ä–∞—à–µ–Ω–æ)
            calculateDensity() {
                const imageData = this.ctx.getImageData(0, 0, this.canvasSize, this.canvasSize);
                const data = imageData.data;
                let coloredPixels = 0;
                
                for (let i = 0; i < data.length; i += 4) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –±–µ–ª—ã–π –ª–∏ –ø–∏–∫—Å–µ–ª—å
                    if (data[i] < 250 || data[i + 1] < 250 || data[i + 2] < 250) {
                        coloredPixels++;
                    }
                }
                
                return coloredPixels / (this.canvasSize * this.canvasSize);
            }

            // –û—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à—Ç—Ä–∏—Ö–∞ (–∫–∞–∫ –≤ Laoshi)
            undo() {
                if (this.strokes.length === 0) return;
                
                // –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —à—Ç—Ä–∏—Ö
                this.strokes.pop();
                this.strokeCount = Math.max(0, this.strokeCount - 1);
                
                // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –≤—Å–µ —à—Ç—Ä–∏—Ö–∏ –∑–∞–Ω–æ–≤–æ
                this.redraw();
            }

            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ—Ö —à—Ç—Ä–∏—Ö–æ–≤
            redraw() {
                this.ctx.clearRect(0, 0, this.canvasSize, this.canvasSize);
                this.ctx.fillStyle = 'white';
                this.ctx.fillRect(0, 0, this.canvasSize, this.canvasSize);
                
                this.ctx.beginPath();
                this.ctx.strokeStyle = '#8B0000';
                this.ctx.lineWidth = 8;
                
                for (let stroke of this.strokes) {
                    if (stroke.length < 2) continue;
                    
                    this.ctx.beginPath();
                    this.ctx.moveTo(stroke[0].x, stroke[0].y);
                    
                    for (let i = 1; i < stroke.length; i++) {
                        this.ctx.lineTo(stroke[i].x, stroke[i].y);
                    }
                    
                    this.ctx.stroke();
                }
                
                this.updateStrokeIndicator();
            }
        }

        // ============================================
        // –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –ö–ê–†–¢–û–ß–ö–ò –†–ò–°–û–í–ê–ù–ò–Ø
        // ============================================
        
        function showLaoshiDrawingCard(word) {
            const content = document.getElementById('card-content');
            content.innerHTML = `
                <div class="laoshi-drawing">
                    <div class="laoshi-title">‚úçÔ∏è –ù–∞–ø–∏—à–∏—Ç–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ</div>
                    <div class="laoshi-translation">${word.translation}</div>
                    
                    <div class="laoshi-canvas-container">
                        <canvas id="laoshi-canvas" width="300" height="300"></canvas>
                        <div class="laoshi-hint" id="laoshi-hint">${word.characters}</div>
                    </div>
                    
                    <div class="stroke-indicator" id="stroke-indicator"></div>
                    
                    <div class="laoshi-controls">
                        <button class="laoshi-btn hint" onclick="window.laoshiDrawing.showHint()">üîç –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                        <button class="laoshi-btn" onclick="window.laoshiDrawing.undo()">‚Ü© –û—Ç–º–µ–Ω–∞</button>
                        <button class="laoshi-btn" onclick="window.laoshiDrawing.clear()">üóë –û—á–∏—Å—Ç–∏—Ç—å</button>
                        <button class="laoshi-btn primary" onclick="checkLaoshiDrawing('${word.id}')">‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    </div>
                    
                    <div class="drawing-feedback" id="drawing-feedback">
                        –ù–∞—Ä–∏—Å—É–π—Ç–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ –ø–∞–ª—å—Ü–µ–º
                    </div>
                </div>
            `;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∏—Å–æ–≤–∞–Ω–∏–µ
            window.laoshiDrawing = new LaoshiDrawing();
            window.laoshiDrawing.init(word);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
        window.checkLaoshiDrawing = function(wordId) {
            const word = wordsData.find(w => w.id == wordId);
            const isCorrect = window.laoshiDrawing.check();
            const feedback = document.getElementById('drawing-feedback');
            
            if (isCorrect) {
                feedback.innerHTML = '<span class="correct-feedback">‚úì –û—Ç–ª–∏—á–Ω–æ! –ü—Ä–∞–≤–∏–ª—å–Ω–æ!</span>';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                word.correctCount++;
                word.timesReviewed++;
                word.lastReviewed = Date.now();
                if (word.correctCount >= 5) word.mastered = 5;
                saveUserProgress();
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∑–∞–¥–∞–Ω–∏—é —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    showIntroCard(word);
                }, 1500);
            } else {
                feedback.innerHTML = '<span class="wrong-feedback">‚úó –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥—Å–∫–∞–∑–∫—É</span>';
            }
        };

        // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –±–ª–æ–∫–∏, —Å–ø–∏—Å–∫–∏) –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
        // ...
    </script>
</body>
</html>
