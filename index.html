<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>HSK 4 | –ö–∏—Ç–∞–π—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #8B0000;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #app {
            width: 100%;
            max-width: 390px;
            height: 100%;
            max-height: 844px;
            background: #FFF5F5;
            position: relative;
            box-shadow: 0 0 20px rgba(139, 0, 0, 0.3);
            border-radius: 40px;
            overflow: hidden;
        }

        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background: #FFF5F5;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }

        .screen.active {
            display: flex;
        }

        .status-bar {
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            font-size: 15px;
            font-weight: 600;
            color: #8B0000;
            background: #FFF5F5;
            flex-shrink: 0;
        }

        .red-button {
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            width: 90%;
            margin: 0 auto;
            display: block;
            flex-shrink: 0;
        }

        .red-button-outline {
            background: white;
            color: #8B0000;
            border: 2px solid #8B0000;
        }

        /* –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ */
        .auth-container {
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            flex-shrink: 0;
        }

        .auth-logo {
            font-size: 48px;
            color: #8B0000;
            margin-bottom: 20px;
        }

        .auth-title {
            font-size: 28px;
            color: #8B0000;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .auth-subtitle {
            color: #666;
            margin-bottom: 30px;
            text-align: center;
        }

        .auth-input {
            width: 100%;
            padding: 16px;
            border: 2px solid #FFE4E1;
            border-radius: 12px;
            font-size: 16px;
            margin-bottom: 15px;
            background: white;
            -webkit-user-select: text;
            user-select: text;
        }

        .auth-input:focus {
            border-color: #8B0000;
            outline: none;
        }

        .auth-button {
            width: 100%;
            padding: 16px;
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .auth-link {
            color: #8B0000;
            text-decoration: none;
            font-size: 15px;
            cursor: pointer;
        }

        .auth-divider {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            margin: 20px 0;
            color: #999;
        }

        .auth-divider::before,
        .auth-divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background: #FFE4E1;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: white;
            border-bottom: 1px solid #FFE4E1;
            flex-shrink: 0;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background: #8B0000;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .user-email {
            flex: 1;
            font-size: 14px;
            color: #333;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .logout-btn {
            padding: 8px 12px;
            background: #FFE4E1;
            border: none;
            border-radius: 8px;
            color: #8B0000;
            font-size: 13px;
            cursor: pointer;
            flex-shrink: 0;
        }

        /* HSK —É—Ä–æ–≤–Ω–∏ */
        .hsk-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 20px;
            flex-shrink: 0;
        }

        .hsk-card {
            background: white;
            border-radius: 20px;
            padding: 20px 10px;
            text-align: center;
            border: 2px solid #FFE4E1;
            cursor: pointer;
        }

        .hsk-card.active {
            border-color: #8B0000;
            background: #FFE4E1;
        }

        .hsk-card .level {
            font-size: 24px;
            font-weight: 700;
            color: #8B0000;
            margin-bottom: 5px;
        }

        .hsk-card .words-count {
            font-size: 14px;
            color: #666;
        }

        /* –ë–ª–æ–∫–∏ —Å–ª–æ–≤ —Å –∏–∫–æ–Ω–∫–∞–º–∏ */
        .section-title {
            padding: 0 20px 10px;
            font-size: 18px;
            font-weight: 600;
            color: #8B0000;
            border-bottom: 2px solid #FFE4E1;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .blocks-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            padding: 0 20px 20px;
            flex-shrink: 0;
        }

        .block-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            border: 1px solid #FFE4E1;
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }

        .block-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .block-icon {
            font-size: 20px;
        }

        .block-name {
            font-size: 14px;
            font-weight: 600;
            color: #8B0000;
        }

        .block-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
        }

        .block-progress {
            height: 6px;
            background: #FFE4E1;
            border-radius: 3px;
            overflow: hidden;
        }

        .block-progress-fill {
            height: 100%;
            background: #8B0000;
            width: 0%;
        }

        /* –ë–∞–Ω–Ω–µ—Ä –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è */
        .review-banner {
            background: #8B0000;
            margin: 15px 20px;
            padding: 16px;
            border-radius: 16px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            animation: pulse 2s infinite;
            flex-shrink: 0;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        /* –ö–æ–ª—å—Ü–µ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ */
        .progress-circle {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
        }

        .progress-circle svg {
            width: 120px;
            height: 120px;
            transform: rotate(-90deg);
        }

        .progress-circle circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
        }

        .progress-circle .bg-circle {
            stroke: #FFE4E1;
        }

        .progress-circle .progress-circle-fill {
            stroke: #8B0000;
            stroke-dasharray: 314;
            stroke-dashoffset: 314;
            transition: stroke-dashoffset 0.5s;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .progress-text .percentage {
            font-size: 24px;
            font-weight: 700;
            color: #8B0000;
        }

        .progress-text .label {
            font-size: 12px;
            color: #666;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–ª–æ–≤–∞ */
        .word-card {
            background: white;
            border-radius: 24px;
            padding: 30px 20px;
            margin: 20px;
            border: 2px solid #FFE4E1;
            text-align: center;
            box-shadow: 0 8px 20px rgba(139, 0, 0, 0.15);
        }

        .word-card-chinese {
            font-size: 64px;
            font-weight: 600;
            color: #8B0000;
            margin-bottom: 10px;
            font-family: 'KaiTi', 'Ê•∑‰Ωì', 'STKaiti', serif;
        }

        .word-card-pinyin {
            font-size: 28px;
            color: #A52A2A;
            margin-bottom: 15px;
        }

        .word-card-translation {
            font-size: 24px;
            color: #8B0000;
            margin-bottom: 25px;
            font-weight: 500;
            padding: 10px;
            background: #FFF5F5;
            border-radius: 16px;
        }

        .word-card-example {
            background: #FFF5F5;
            padding: 20px;
            border-radius: 16px;
            margin: 15px 0;
            border: 1px solid #FFE4E1;
        }

        .word-card-example-chinese {
            font-size: 20px;
            margin-bottom: 8px;
            color: #8B0000;
        }

        .word-card-example-translation {
            color: #666;
            font-size: 16px;
        }

        .word-card-audio {
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background: #8B0000;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px auto;
            cursor: pointer;
            font-size: 28px;
            color: white;
            box-shadow: 0 4px 10px rgba(139, 0, 0, 0.3);
        }

        .word-card-audio:active {
            transform: scale(0.95);
        }

        .word-card-close {
            margin-top: 20px;
            padding: 12px 24px;
            background: #FFE4E1;
            border: none;
            border-radius: 30px;
            color: #8B0000;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        /* –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –≤ –±–ª–æ–∫–µ */
        .words-list {
            padding: 0 20px 20px;
        }

        .word-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid #FFE4E1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: 0.2s;
        }

        .word-item:active {
            transform: scale(0.98);
            background: #FFE4E1;
        }

        .word-item-left {
            display: flex;
            flex-direction: column;
        }

        .word-item .chinese {
            font-size: 18px;
            font-weight: 600;
            color: #8B0000;
        }

        .word-item .pinyin-small {
            font-size: 14px;
            color: #A52A2A;
        }

        .word-item .translation-small {
            font-size: 14px;
            color: #666;
        }

        .word-item .mastered-badge {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }

        .word-item .not-mastered-badge {
            background: #FFE4E1;
            color: #8B0000;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–ª–æ–∫–∞ */
        .block-progress-container {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin: 20px;
            border: 1px solid #FFE4E1;
        }

        .block-progress-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .block-progress-bar-big {
            height: 12px;
            background: #FFE4E1;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .block-progress-fill-big {
            height: 100%;
            background: #8B0000;
            width: 0%;
            border-radius: 6px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ */
        .training-card {
            background: white;
            border-radius: 24px;
            padding: 20px;
            margin: 20px;
            border: 2px solid #FFE4E1;
            text-align: center;
        }

        .training-progress {
            font-size: 14px;
            color: #8B0000;
            margin-bottom: 10px;
        }

        .training-question {
            font-size: 18px;
            color: #666;
            margin: 15px 0;
        }

        .training-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .training-option {
            background: white;
            border: 2px solid #FFE4E1;
            border-radius: 12px;
            padding: 16px;
            font-size: 18px;
            cursor: pointer;
            transition: 0.2s;
        }

        .training-option:active {
            background: #FFE4E1;
        }

        .training-option.correct {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .training-option.wrong {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .training-result {
            margin: 15px 0;
            font-size: 16px;
            font-weight: 500;
        }

        .training-result.correct {
            color: #4CAF50;
        }

        .training-result.wrong {
            color: #f44336;
        }

        .training-next {
            margin-top: 20px;
            padding: 12px 24px;
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .training-next:disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        /* –ö–Ω–æ–ø–∫–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è */
        .review-complete {
            text-align: center;
            padding: 40px 20px;
        }

        .review-complete h2 {
            color: #8B0000;
            font-size: 28px;
            margin-bottom: 20px;
        }

        .review-complete p {
            color: #666;
            margin-bottom: 30px;
        }

        .review-button {
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 16px 32px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px;
        }

        .audio-btn {
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background: #8B0000;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px auto;
            cursor: pointer;
            font-size: 28px;
            color: white;
        }

        .bottom-nav {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid #FFE4E1;
            background: white;
            margin-top: auto;
            flex-shrink: 0;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #999;
            font-size: 12px;
            cursor: pointer;
        }

        .nav-item.active {
            color: #8B0000;
        }

        .nav-icon {
            font-size: 22px;
            margin-bottom: 4px;
        }

        .back-btn {
            font-size: 24px;
            cursor: pointer;
            color: white;
        }

        .scroll-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 20px;
        }

        .feedback-overlay {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 80px;
            z-index: 1000;
            animation: popIn 0.5s;
            pointer-events: none;
        }

        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0); }
            80% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
        <div id="auth-screen" class="screen active">
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            
            <div class="scroll-content">
                <div class="auth-container">
                    <div class="auth-logo">üÄÑÔ∏è</div>
                    <div class="auth-title">HSK 4</div>
                    <div class="auth-subtitle">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</div>
                    
                    <div style="width: 100%;">
                        <input type="email" id="login-email" class="auth-input" placeholder="Email" value="user@example.com">
                        <input type="password" id="login-password" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å" value="123456">
                        <button class="auth-button" id="login-btn">–í–æ–π—Ç–∏</button>
                        
                        <div class="auth-divider">–∏–ª–∏</div>
                        
                        <button class="auth-button" id="register-btn" style="background: white; color: #8B0000; border: 2px solid #8B0000;">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                    </div>
                    
                    <div style="margin-top: 30px; text-align: center;">
                        <span class="auth-link" id="guest-link">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫–∞–∫ –≥–æ—Å—Ç—å</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="register-screen" class="screen">
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            
            <div style="padding: 20px; flex-shrink: 0;">
                <span class="back-btn" id="back-to-auth" style="color: #8B0000; font-size: 24px; cursor: pointer;">‚Üê</span>
            </div>
            
            <div class="scroll-content">
                <div class="auth-container">
                    <div class="auth-logo">üÄÑÔ∏è</div>
                    <div class="auth-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                    <div class="auth-subtitle">–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</div>
                    
                    <div style="width: 100%;">
                        <input type="text" id="register-name" class="auth-input" placeholder="–ò–º—è" value="–í–ª–∞–¥–∞">
                        <input type="email" id="register-email" class="auth-input" placeholder="Email" value="vladamalova@example.com">
                        <input type="password" id="register-password" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å" value="123456">
                        <input type="password" id="register-confirm" class="auth-input" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" value="123456">
                        <button class="auth-button" id="register-submit-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —Å HSK —É—Ä–æ–≤–Ω—è–º–∏ -->
        <div id="hsk-screen" class="screen">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar">–í</div>
                <div class="user-email" id="user-email">vladamalova@example.com</div>
                <button class="logout-btn" id="logout-btn">–í—ã–π—Ç–∏</button>
            </div>
            
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            
            <div class="scroll-content">
                <div style="padding: 20px;">
                    <h1 style="font-size: 32px; color: #8B0000; margin-bottom: 5px;">HSK Ê±âËØ≠</h1>
                    <p style="color: #666; margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å</p>
                </div>
                
                <div class="hsk-grid" id="hsk-grid">
                    <div class="hsk-card" data-hsk="1">
                        <div class="level">HSK 1</div>
                        <div class="words-count">150 —Å–ª–æ–≤</div>
                    </div>
                    <div class="hsk-card" data-hsk="2">
                        <div class="level">HSK 2</div>
                        <div class="words-count">300 —Å–ª–æ–≤</div>
                    </div>
                    <div class="hsk-card" data-hsk="3">
                        <div class="level">HSK 3</div>
                        <div class="words-count">600 —Å–ª–æ–≤</div>
                    </div>
                    <div class="hsk-card active" data-hsk="4">
                        <div class="level">HSK 4</div>
                        <div class="words-count">1200 —Å–ª–æ–≤</div>
                    </div>
                    <div class="hsk-card" data-hsk="5">
                        <div class="level">HSK 5</div>
                        <div class="words-count">1300 —Å–ª–æ–≤</div>
                    </div>
                    <div class="hsk-card" data-hsk="6">
                        <div class="level">HSK 6</div>
                        <div class="words-count">2500+ —Å–ª–æ–≤</div>
                    </div>
                </div>
                
                <div style="padding: 20px;">
                    <button class="red-button" id="select-hsk-btn" style="width: 100%;">–í—ã–±—Ä–∞—Ç—å HSK 4</button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Å –±–ª–æ–∫–∞–º–∏ —Å–ª–æ–≤ HSK 4 -->
        <div id="blocks-screen" class="screen">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar-blocks">–í</div>
                <div class="user-email" id="user-email-blocks">vladamalova@example.com</div>
                <button class="logout-btn" id="logout-btn-blocks">–í—ã–π—Ç–∏</button>
            </div>
            
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            <div style="background: #8B0000; color: white; padding: 15px; display: flex; align-items: center; gap: 15px; flex-shrink: 0;">
                <span class="back-btn" id="back-to-hsk">‚Üê</span>
                <h2 style="font-size: 24px;">HSK 4</h2>
            </div>
            
            <div class="scroll-content">
                <div id="review-banner" class="review-banner" style="display: none;">
                    <span>–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–ª–æ–≤–∞</span>
                    <span id="review-count">0</span>
                </div>
                
                <div style="padding: 20px;">
                    <div style="background: white; border-radius: 20px; padding: 20px; border: 1px solid #FFE4E1;">
                        <div style="font-size: 18px; color: #8B0000; font-weight: 600; margin-bottom: 15px;">–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å HSK 4</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>–í—ã—É—á–µ–Ω–æ —Å–ª–æ–≤:</span>
                            <span style="color: #8B0000; font-weight: 600;" id="total-mastered">0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <span>–í—Å–µ–≥–æ —Å–ª–æ–≤:</span>
                            <span style="color: #666;" id="total-words">1200</span>
                        </div>
                        <div style="height: 10px; background: #FFE4E1; border-radius: 5px;">
                            <div id="total-progress" style="height: 100%; background: #8B0000; width: 0%; border-radius: 5px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">–¢–µ–º—ã HSK 4</div>
                <div class="blocks-grid" id="blocks-container"></div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞ -->
        <div id="block-detail-screen" class="screen">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar-detail">–í</div>
                <div class="user-email" id="user-email-detail">vladamalova@example.com</div>
                <button class="logout-btn" id="logout-btn-detail">–í—ã–π—Ç–∏</button>
            </div>
            
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            <div style="background: #8B0000; color: white; padding: 15px; display: flex; align-items: center; gap: 15px; flex-shrink: 0;">
                <span class="back-btn" id="back-to-blocks">‚Üê</span>
                <h2 id="block-title" style="font-size: 24px;">–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏</h2>
            </div>
            
            <div class="scroll-content">
                <div class="block-progress-container">
                    <div class="block-progress-stats">
                        <span>–ü—Ä–æ–≥—Ä–µ—Å—Å –±–ª–æ–∫–∞</span>
                        <span id="block-mastered-count">0</span>
                    </div>
                    <div class="block-progress-bar-big">
                        <div class="block-progress-fill-big" id="block-progress-bar" style="width: 0%"></div>
                    </div>
                    <button class="red-button" id="study-block-btn" style="width: 100%;">–£—á–∏—Ç—å —Å–ª–æ–≤–∞</button>
                </div>
                
                <div class="section-title">–°–ø–∏—Å–æ–∫ —Å–ª–æ–≤</div>
                <div class="words-list" id="words-list-container"></div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–ª–æ–≤–∞ -->
        <div id="word-card-screen" class="screen">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar-card">–í</div>
                <div class="user-email" id="user-email-card">vladamalova@example.com</div>
                <button class="logout-btn" id="logout-btn-card">–í—ã–π—Ç–∏</button>
            </div>
            
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            
            <div style="padding: 15px; flex-shrink: 0;">
                <span class="back-btn" id="back-to-block-from-card" style="color: #8B0000; font-size: 24px; cursor: pointer;">‚Üê</span>
            </div>
            
            <div class="scroll-content" id="word-card-content">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–ª–æ–≤–∞ –±—É–¥–µ—Ç –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å—é–¥–∞ -->
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
        <div id="training-screen" class="screen">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar-training">–í</div>
                <div class="user-email" id="user-email-training">vladamalova@example.com</div>
                <button class="logout-btn" id="logout-btn-training">–í—ã–π—Ç–∏</button>
            </div>
            
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            
            <div class="scroll-content" id="training-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–ª–æ–∫–∞ -->
        <div id="block-complete-screen" class="screen">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar-complete">–í</div>
                <div class="user-email" id="user-email-complete">vladamalova@example.com</div>
                <button class="logout-btn" id="logout-btn-complete">–í—ã–π—Ç–∏</button>
            </div>
            
            <div class="status-bar">
                <span>9:41</span>
                <span>üîã 100%</span>
            </div>
            
            <div class="scroll-content">
                <div class="review-complete">
                    <div style="font-size: 80px; margin-bottom: 20px;">üéâ</div>
                    <h2>–ë–ª–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω!</h2>
                    <p>–í—ã –≤—ã—É—á–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤ —ç—Ç–æ–º –±–ª–æ–∫–µ. –•–æ—Ç–∏—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å?</p>
                    <button class="review-button" id="review-block-btn">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å 10 —Å–ª–æ–≤</button>
                    <button class="review-button" style="background: white; color: #8B0000; border: 2px solid #8B0000;" id="back-to-blocks-complete">–ö —Å–ø–∏—Å–∫—É –±–ª–æ–∫–æ–≤</button>
                </div>
            </div>
        </div>
    </div>

    <div id="feedback-overlay" class="feedback-overlay" style="display: none;"></div>

    <script>
        // ============================================
        // –°–ò–°–¢–ï–ú–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
        // ============================================
        
        let users = {};
        let currentUser = null;
        
        function loadUsers() {
            const saved = localStorage.getItem('hsk4_users');
            if (saved) {
                users = JSON.parse(saved);
            } else {
                users = {
                    'vladamalova@example.com': {
                        name: '–í–ª–∞–¥–∞',
                        email: 'vladamalova@example.com',
                        password: '123456',
                        progress: {}
                    }
                };
                saveUsers();
            }
        }
        
        function saveUsers() {
            localStorage.setItem('hsk4_users', JSON.stringify(users));
        }
        
        function loadUserProgress() {
            if (!currentUser) return;
            
            const user = users[currentUser];
            if (user && user.progress) {
                wordsData.forEach(word => {
                    if (user.progress[word.id]) {
                        word.mastered = user.progress[word.id].mastered || 0;
                        word.timesReviewed = user.progress[word.id].timesReviewed || 0;
                        word.correctCount = user.progress[word.id].correctCount || 0;
                        word.lastReviewed = user.progress[word.id].lastReviewed || null;
                    } else {
                        word.mastered = 0;
                        word.timesReviewed = 0;
                        word.correctCount = 0;
                        word.lastReviewed = null;
                    }
                });
            }
        }
        
        function saveUserProgress() {
            if (!currentUser) return;
            
            const progress = {};
            wordsData.forEach(word => {
                progress[word.id] = {
                    mastered: word.mastered,
                    timesReviewed: word.timesReviewed,
                    correctCount: word.correctCount,
                    lastReviewed: word.lastReviewed
                };
            });
            
            if (users[currentUser]) {
                users[currentUser].progress = progress;
                saveUsers();
            }
        }
        
        function updateUserUI() {
            const user = currentUser ? users[currentUser] : null;
            const userInitial = user ? user.name.charAt(0).toUpperCase() : '–ì';
            const userEmail = user ? user.email : '–ì–æ—Å—Ç—å';
            
            document.querySelectorAll('[id^="user-avatar"]').forEach(el => {
                el.textContent = userInitial;
            });
            
            document.querySelectorAll('[id^="user-email"]').forEach(el => {
                el.textContent = userEmail;
            });
        }
        
        function logout() {
            saveUserProgress();
            currentUser = null;
            showScreen('auth-screen');
        }

        // ============================================
        // –í–°–ï –í–ê–®–ò –°–õ–û–í–ê HSK 4
        // ============================================
        
        const wordsData = [
            { id: 1, characters: "Âπ≤ÊùØ", pinyin: "gƒÅn bƒìi", translation: "—á–æ–∫–∞—Ç—å—Å—è / –¥–æ –¥–Ω–∞", example: "Êàë‰ª¨Êù•Âπ≤ÊùØÔºÅ", exampleTranslation: "–î–∞–≤–∞–π—Ç–µ —á–æ–∫–Ω–µ–º—Å—è!", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 2, characters: "È•ºÂπ≤", pinyin: "b«êng gƒÅn", translation: "–ø–µ—á–µ–Ω—å–µ", example: "ÊàëÂñúÊ¨¢ÂêÉÈ•ºÂπ≤„ÄÇ", exampleTranslation: "–Ø –ª—é–±–ª—é –µ—Å—Ç—å –ø–µ—á–µ–Ω—å–µ.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 3, characters: "È•∫Â≠ê", pinyin: "ji«éo zi", translation: "–ø–µ–ª—å–º–µ–Ω–∏ / —Ü–∑—è–æ—Ü–∑—ã", example: "Â¶àÂ¶àÂåÖ‰∫ÜÈ•∫Â≠ê„ÄÇ", exampleTranslation: "–ú–∞–º–∞ —Å–ª–µ–ø–∏–ª–∞ –ø–µ–ª—å–º–µ–Ω–∏.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 4, characters: "Ê±§", pinyin: "tƒÅng", translation: "—Å—É–ø", example: "Ê±§ÂæàÁÉ≠„ÄÇ", exampleTranslation: "–°—É–ø –≥–æ—Ä—è—á–∏–π.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 5, characters: "Ë•øÁ∫¢Êüø", pinyin: "xƒ´ h√≥ng sh√¨", translation: "–ø–æ–º–∏–¥–æ—Ä", example: "Ë•øÁ∫¢ÊüøÁÇíÈ∏°Ëõã", exampleTranslation: "–Ø–∏—á–Ω–∏—Ü–∞ —Å –ø–æ–º–∏–¥–æ—Ä–∞–º–∏.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 6, characters: "Áì∂Â≠ê", pinyin: "p√≠ng zi", translation: "–±—É—Ç—ã–ª–∫–∞", example: "‰∏ÄÁì∂Ê∞¥", exampleTranslation: "–û–¥–Ω–∞ –±—É—Ç—ã–ª–∫–∞ –≤–æ–¥—ã.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 7, characters: "ÂàÄ", pinyin: "dƒÅo", translation: "–Ω–æ–∂", example: "ËøôÊääÂàÄÂæàÈîãÂà©„ÄÇ", exampleTranslation: "–≠—Ç–æ—Ç –Ω–æ–∂ –æ—á–µ–Ω—å –æ—Å—Ç—Ä—ã–π.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 8, characters: "Â∑ßÂÖãÂäõ", pinyin: "qi«éo k√® l√¨", translation: "—à–æ–∫–æ–ª–∞–¥", example: "ÊàëÂñúÊ¨¢ÂêÉÂ∑ßÂÖãÂäõ„ÄÇ", exampleTranslation: "–Ø –ª—é–±–ª—é —à–æ–∫–æ–ª–∞–¥.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 9, characters: "È•ÆÊñô", pinyin: "y«ên li√†o", translation: "–Ω–∞–ø–∏—Ç–æ–∫", example: "‰Ω†ÊÉ≥Âñù‰ªÄ‰πàÈ•ÆÊñôÔºü", exampleTranslation: "–ö–∞–∫–æ–π –Ω–∞–ø–∏—Ç–æ–∫ —Ç—ã —Ö–æ—á–µ—à—å?", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null },
            { id: 10, characters: "È£üÂìÅ", pinyin: "sh√≠ p«ên", translation: "–ø—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è", example: "ËøôÂÆ∂Â∫óÂçñÈ£üÂìÅ„ÄÇ", exampleTranslation: "–≠—Ç–æ—Ç –º–∞–≥–∞–∑–∏–Ω –ø—Ä–æ–¥–∞—ë—Ç –ø—Ä–æ–¥—É–∫—Ç—ã.", listId: 1, mastered: 0, timesReviewed: 0, correctCount: 0, lastReviewed: null }
        ];

        // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–æ 1200
        for (let i = 11; i <= 1200; i++) {
            wordsData.push({
                id: i,
                characters: `ËØç${i}`,
                pinyin: `c√≠ ${i}`,
                translation: `—Å–ª–æ–≤–æ ${i}`,
                example: `ËøôÊòØËØç${i}„ÄÇ`,
                exampleTranslation: `–≠—Ç–æ —Å–ª–æ–≤–æ ${i}.`,
                listId: Math.floor(i / 45) + 1,
                mastered: 0,
                timesReviewed: 0,
                correctCount: 0,
                lastReviewed: null
            });
        }

        // –ë–ª–æ–∫–∏ (27 —Ç–µ–º)
        const blocks = [
            { id: 1, name: "–ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏", icon: "üçú", count: 20 },
            { id: 2, name: "–û–±—É—á–µ–Ω–∏–µ", icon: "üìö", count: 20 },
            { id: 3, name: "–†–∞–±–æ—Ç–∞ –∏ –¥–µ–Ω—å–≥–∏", icon: "üíº", count: 24 },
            { id: 4, name: "–£—Å–ø–µ—Ö –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ", icon: "üìà", count: 23 },
            { id: 5, name: "–°–µ–º—å—è –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è", icon: "üë®‚Äçüë©‚Äçüëß", count: 33 },
            { id: 6, name: "–≠–º–æ—Ü–∏–∏ –∏ —á—É–≤—Å—Ç–≤–∞", icon: "‚ù§Ô∏è", count: 30 },
            { id: 7, name: "–õ–∏—á–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞", icon: "‚≠ê", count: 23 },
            { id: 8, name: "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è", icon: "‚úàÔ∏è", count: 18 },
            { id: 9, name: "–ö–ª–∏–º–∞—Ç –∏ –ø—Ä–∏—Ä–æ–¥–∞", icon: "üå¶Ô∏è", count: 27 },
            { id: 10, name: "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", icon: "üé≠", count: 23 },
            { id: 11, name: "–ù–∞—Ä–µ—á–∏—è 1", icon: "üìù", count: 23 },
            { id: 12, name: "–ù–∞—Ä–µ—á–∏—è 2", icon: "üìù", count: 22 },
            { id: 13, name: "–í—Ä–µ–º—è", icon: "‚è∞", count: 19 },
            { id: 14, name: "–ü–æ–∫—É–ø–∫–∏", icon: "üõçÔ∏è", count: 20 },
            { id: 15, name: "–ó–∞–∫–æ–Ω –∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ", icon: "‚öñÔ∏è", count: 29 },
            { id: 16, name: "–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑", icon: "üìä", count: 27 },
            { id: 17, name: "–î–æ–º –∏ –±—ã—Ç", icon: "üè†", count: 31 },
            { id: 18, name: "–û—Ñ–∏—Å", icon: "üíª", count: 14 },
            { id: 19, name: "–ú–µ—Å—Ç–æ –∏ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏–µ", icon: "üìç", count: 20 },
            { id: 20, name: "–î–∏–∞–ª–æ–≥ –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ", icon: "üí¨", count: 25 },
            { id: 21, name: "–£–º–æ–∑–∞–∫–ª—é—á–µ–Ω–∏—è", icon: "ü§î", count: 20 },
            { id: 22, name: "–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞", icon: "üîß", count: 11 },
            { id: 23, name: "–°–ª—É–∂–µ–±–Ω—ã–µ —Å–ª–æ–≤–∞", icon: "üî§", count: 19 },
            { id: 24, name: "–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ", icon: "üìã", count: 28 },
            { id: 25, name: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", icon: "üì¢", count: 23 },
            { id: 26, name: "–ó–¥–æ—Ä–æ–≤—å–µ –∏ —Å–ø–æ—Ä—Ç", icon: "üè•", count: 23 },
            { id: 27, name: "–ì–ª–∞–≥–æ–ª—ã", icon: "üî®", count: 15 }
        ];

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let currentHSK = 4;
        let currentBlock = 1;
        let trainingWords = [];
        let currentTrainingIndex = 0;
        let correctAnswers = 0;
        let reviewMode = false;

        // ============================================
        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ü–†–û–ì–†–ï–°–°–û–ú
        // ============================================
        
        function getWordsByBlock(blockId) {
            return wordsData.filter(w => w.listId === blockId);
        }

        function getBlockStats(blockId) {
            const words = getWordsByBlock(blockId);
            const total = words.length;
            const mastered = words.filter(w => w.mastered >= 5).length;
            return { total, mastered };
        }

        function getTotalStats() {
            const total = wordsData.length;
            const mastered = wordsData.filter(w => w.mastered >= 5).length;
            return { total, mastered };
        }

        function updateReviewBanner() {
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        }

        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN';
            utterance.rate = 0.9;
            window.speechSynthesis.speak(utterance);
        }

        function showFeedback(isCorrect) {
            const overlay = document.getElementById('feedback-overlay');
            overlay.textContent = isCorrect ? '‚úì' : '‚úó';
            overlay.style.color = isCorrect ? '#4CAF50' : '#f44336';
            overlay.style.display = 'block';
            setTimeout(() => overlay.style.display = 'none', 500);
        }

        // ============================================
        // –§–£–ù–ö–¶–ò–ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø
        // ============================================
        
        function renderBlocksScreen() {
            const stats = getTotalStats();
            document.getElementById('total-mastered').textContent = stats.mastered;
            document.getElementById('total-words').textContent = stats.total;
            document.getElementById('total-progress').style.width = (stats.mastered / stats.total * 100) + '%';
            
            const container = document.getElementById('blocks-container');
            container.innerHTML = '';
            
            blocks.forEach(block => {
                const blockStats = getBlockStats(block.id);
                const progress = (blockStats.mastered / block.count * 100) || 0;
                
                container.innerHTML += `
                    <div class="block-card" data-block="${block.id}">
                        <div class="block-header">
                            <span class="block-icon">${block.icon}</span>
                            <span class="block-name">${block.name}</span>
                        </div>
                        <div class="block-stats">
                            <span>${blockStats.mastered}/${block.count}</span>
                            <span>${Math.round(progress)}%</span>
                        </div>
                        <div class="block-progress">
                            <div class="block-progress-fill" style="width: ${progress}%"></div>
                        </div>
                    </div>
                `;
            });
            
            document.querySelectorAll('.block-card').forEach(card => {
                card.addEventListener('click', () => {
                    const blockId = parseInt(card.dataset.block);
                    showBlockDetail(blockId);
                });
            });
        }

        function showBlockDetail(blockId) {
            currentBlock = blockId;
            const block = blocks.find(b => b.id === blockId);
            document.getElementById('block-title').textContent = block.name;
            
            const stats = getBlockStats(blockId);
            document.getElementById('block-mastered-count').textContent = `${stats.mastered}/${stats.total}`;
            document.getElementById('block-progress-bar').style.width = (stats.mastered / stats.total * 100) + '%';
            
            const words = getWordsByBlock(blockId);
            const container = document.getElementById('words-list-container');
            container.innerHTML = '';
            
            words.forEach(word => {
                container.innerHTML += `
                    <div class="word-item" data-word-id="${word.id}">
                        <div class="word-item-left">
                            <span class="chinese">${word.characters}</span>
                            <span class="pinyin-small">${word.pinyin}</span>
                            <span class="translation-small">${word.translation}</span>
                        </div>
                        ${word.mastered >= 5 ? 
                            '<span class="mastered-badge">‚úì –í—ã—É—á–µ–Ω–æ</span>' : 
                            '<span class="not-mastered-badge">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</span>'}
                    </div>
                `;
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–∞ –Ω–∞ —Å–ª–æ–≤–∞
            document.querySelectorAll('.word-item').forEach(item => {
                item.addEventListener('click', () => {
                    const wordId = parseInt(item.dataset.wordId);
                    showWordCard(wordId);
                });
            });
            
            showScreen('block-detail-screen');
        }

        function showWordCard(wordId) {
            const word = wordsData.find(w => w.id === wordId);
            
            document.getElementById('word-card-content').innerHTML = `
                <div class="word-card">
                    <div class="word-card-chinese">${word.characters}</div>
                    <div class="word-card-pinyin">${word.pinyin}</div>
                    <div class="word-card-translation">${word.translation}</div>
                    <div class="word-card-audio" onclick="speak('${word.characters}')">üîä</div>
                    <div class="word-card-example">
                        <div class="word-card-example-chinese">${word.example}</div>
                        <div class="word-card-example-translation">${word.exampleTranslation}</div>
                    </div>
                    <button class="word-card-close" onclick="goBackToBlock()">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            `;
            
            showScreen('word-card-screen');
        }

        function goBackToBlock() {
            showScreen('block-detail-screen');
        }

        function startTraining(blockId, isReview = false) {
            const allWords = getWordsByBlock(blockId);
            
            if (isReview) {
                // –ë–µ—Ä–µ–º —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è (–≤—ã—É—á–µ–Ω–Ω—ã–µ)
                trainingWords = allWords.filter(w => w.mastered >= 5);
                if (trainingWords.length === 0) {
                    alert('–ù–µ—Ç —Å–ª–æ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è');
                    return;
                }
            } else {
                // –ë–µ—Ä–µ–º –Ω–µ–≤—ã—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
                trainingWords = allWords.filter(w => w.mastered < 5);
                if (trainingWords.length === 0) {
                    // –ï—Å–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤—ã—É—á–µ–Ω—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
                    showScreen('block-complete-screen');
                    return;
                }
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∏ –±–µ—Ä–µ–º –¥–æ 10 —Å–ª–æ–≤
            trainingWords = shuffleArray(trainingWords).slice(0, 10);
            currentTrainingIndex = 0;
            correctAnswers = 0;
            reviewMode = isReview;
            
            showTrainingCard();
            showScreen('training-screen');
        }

        function showTrainingCard() {
            if (currentTrainingIndex >= trainingWords.length) {
                // –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
                if (reviewMode) {
                    showScreen('block-detail-screen');
                } else {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ —Å–ª–æ–≤–∞ –≤—ã—É—á–µ–Ω—ã
                    const blockWords = getWordsByBlock(currentBlock);
                    const allMastered = blockWords.every(w => w.mastered >= 5);
                    
                    if (allMastered) {
                        showScreen('block-complete-screen');
                    } else {
                        showScreen('block-detail-screen');
                    }
                }
                return;
            }
            
            const word = trainingWords[currentTrainingIndex];
            
            // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
            const otherWords = wordsData.filter(w => w.id !== word.id);
            const options = [word, ...shuffleArray(otherWords).slice(0, 3)];
            const shuffledOptions = shuffleArray(options);
            
            document.getElementById('training-content').innerHTML = `
                <div class="training-card">
                    <div class="training-progress">
                        –°–ª–æ–≤–æ ${currentTrainingIndex + 1} –∏–∑ ${trainingWords.length}
                    </div>
                    
                    <div class="training-question">
                        –ö–∞–∫ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è —Å–ª–æ–≤–æ?
                    </div>
                    
                    <div class="chinese-char" style="font-size: 48px; margin: 20px 0;">
                        ${word.characters}
                    </div>
                    
                    <div class="audio-btn" onclick="speak('${word.characters}')">üîä</div>
                    
                    <div class="training-options" id="training-options">
                        ${shuffledOptions.map(opt => `
                            <div class="training-option" onclick="checkTrainingAnswer(this, '${opt.translation}', '${word.translation}', ${word.id})">
                                ${opt.translation}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div id="training-result" class="training-result"></div>
                    
                    <button class="training-next" id="training-next-btn" onclick="nextTrainingCard()" disabled>
                        –î–∞–ª–µ–µ
                    </button>
                </div>
            `;
        }

        window.checkTrainingAnswer = function(element, selected, correct, wordId) {
            const word = wordsData.find(w => w.id === wordId);
            const options = document.querySelectorAll('.training-option');
            const nextBtn = document.getElementById('training-next-btn');
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∫–ª–∏–∫–∏
            options.forEach(opt => opt.style.pointerEvents = 'none');
            
            if (selected === correct) {
                element.classList.add('correct');
                showFeedback(true);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–ª–æ–≤–∞
                word.correctCount = (word.correctCount || 0) + 1;
                word.timesReviewed = (word.timesReviewed || 0) + 1;
                word.lastReviewed = Date.now();
                
                if (word.correctCount >= 5) {
                    word.mastered = 5;
                }
                
                correctAnswers++;
                saveUserProgress();
                
                document.getElementById('training-result').innerHTML = 
                    '<span class="correct-feedback">‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!</span>';
            } else {
                element.classList.add('wrong');
                showFeedback(false);
                document.getElementById('training-result').innerHTML = 
                    '<span class="wrong-feedback">‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ' + correct + '</span>';
            }
            
            nextBtn.disabled = false;
        };

        window.nextTrainingCard = function() {
            currentTrainingIndex++;
            showTrainingCard();
        };

        function endStudy() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadUsers();
        loadUserProgress();

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        document.getElementById('login-btn').addEventListener('click', () => {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (users[email] && users[email].password === password) {
                currentUser = email;
                loadUserProgress();
                updateUserUI();
                showScreen('hsk-screen');
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
            }
        });

        document.getElementById('register-btn').addEventListener('click', () => {
            showScreen('register-screen');
        });

        document.getElementById('back-to-auth').addEventListener('click', () => {
            showScreen('auth-screen');
        });

        document.getElementById('register-submit-btn').addEventListener('click', () => {
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;
            
            if (!name || !email || !password) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            if (password !== confirm) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                return;
            }
            
            if (users[email]) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            users[email] = {
                name: name,
                email: email,
                password: password,
                progress: {}
            };
            
            saveUsers();
            alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏.');
            showScreen('auth-screen');
        });

        document.getElementById('guest-link').addEventListener('click', () => {
            currentUser = null;
            updateUserUI();
            showScreen('hsk-screen');
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã—Ö–æ–¥–∞
        document.querySelectorAll('[id^="logout-btn"]').forEach(btn => {
            btn.addEventListener('click', logout);
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        document.querySelectorAll('.hsk-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.hsk-card').forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                currentHSK = parseInt(card.dataset.hsk);
            });
        });

        document.getElementById('select-hsk-btn').addEventListener('click', () => {
            renderBlocksScreen();
            showScreen('blocks-screen');
        });

        document.getElementById('back-to-hsk').addEventListener('click', () => {
            showScreen('hsk-screen');
        });

        document.getElementById('back-to-blocks').addEventListener('click', () => {
            showScreen('blocks-screen');
        });

        document.getElementById('back-to-block-from-card').addEventListener('click', () => {
            showScreen('block-detail-screen');
        });

        document.getElementById('study-block-btn').addEventListener('click', () => {
            startTraining(currentBlock, false);
        });

        document.getElementById('review-block-btn').addEventListener('click', () => {
            startTraining(currentBlock, true);
        });

        document.getElementById('back-to-blocks-complete').addEventListener('click', () => {
            showScreen('blocks-screen');
        });

        window.addEventListener('beforeunload', () => {
            saveUserProgress();
        });
        
        window.speechSynthesis.getVoices();
    </script>
</body>
</html>
